## 1. 网络的平衡
### 1.1. 完全图的平衡
我们称一个三节点的完全图是平衡的, 当且仅当在这个节点组中, 要么三条边都被标记为$+$, 要么只有一条边被标记为$+$. 

我们称一个完全图是平衡的, 当且仅当它其中的每一个三节点的节点组都是平衡的. 这个条件可以规约为以下两种情形之一: 
1. 完全图中的任意一条边都是$+$
2. 完全图的节点集可以被分成两组, 组内的所有边都被标记为$+$, 组间的所有边都被标记为$-$.


### 1.2. 一般网络的平衡
一个非完全图, 如果通过增加一些边可以形成平衡的完全图, 则称该图是平衡的. 

一般网络的平衡问题可以被规约为: 标注图图$G$的节点集可以被划分为两组, 组内的所有边都被标记为$+$, 组间的所有边都被标记为$-$.


### 1.3. 平衡网络的刻画
一个标注图是平衡的, 当且仅当它不包含有奇数条负关系边的圈. 
___
##### Proof
对于一个平衡的标注图, 假设其存在一个圈$v_1v_2\cdots v_k v_1$含有奇数条负关系边. 由于平衡的标注图的节点集可以被划分为两组, 组内所有边都是正关系边, 组间所有边都是负关系边. 因此负关系边连接的两个端点属于不同的组. 沿着圈走下去就得到了$v_1$和$v_1$应该属于不同的组, 矛盾!

假设一个标注图不含有包含奇数条负关系边的圈. 那么从任何一个节点$v$出发. 将正关系边连接的两个端点放入同一组, 将负关系边连接的两个端点放入不同组. 最后得到了标注图节点集合的一个划分. 这个划分满足组内的所有边都被标记为$+$, 组间的所有边都被标记为$-$, 因此是平衡的. 
#####
___

### 1.4. 近似平衡的网络
设定$\varepsilon\in \left[0, \dfrac{1}{8}\right)$为任意数, 定义$\delta = \sqrt[3]{\varepsilon}$. 如果在完全图中至少有$1-\varepsilon$占比的三角形是平衡的, 那么有下面两种情形之一成立
1. 至少存在$1-\delta$占比的节点, 其中至少$1-\delta$占比的节点对都互为朋友
2. 可以将节点划分为两个集合, 满足集合内部至少有$1-\delta$占比的节点对互为朋友, 而集合间至少有$1-\delta$占比的节点对互为敌人.

这里$\delta$和$\varepsilon$的关系无法再改进. 
___
##### Proof
对于有$N$个节点的完全图, 三角形的总数为$\dfrac{N(N-1)(N-2)}{6}$. 不平衡三角形的总数最多为$\varepsilon\dfrac{N(N-1)(N-2)}{6}$, 定义节点的不平衡量为其所涉及的不平衡三角形数, 记为$\mathrm{ub}(v)$. 则
$$
\sum\limits_{v}^{} \mathrm{ub}(v) = \varepsilon\dfrac{N(N-1)(N-2)}{6} \le \varepsilon\dfrac{N^3}{6}
$$
根据鸽笼原理, 至少存在一个节点$A$, $\mathrm{ub}(A)\le \varepsilon\dfrac{N^2}{2}$. 我们将图分成两个集合, 集合$X$包含节点$A$和它的所有朋友, 集合$Y$包含$A$的所有敌人. 

集合$X$中的两个节点之间的负关系边, 对应一个包含节点$A$的不平衡三角形, 由于最多有$\dfrac{\varepsilon N^2}{2}$个不平衡三角形包含节点$A$, 所以在集合$X$中最多有$\dfrac{\varepsilon N^2}{2}$个负关系边. 同理, 集合$Y$中也最多有$\dfrac{\varepsilon N^2}{2}$个负关系边. $X$和$Y$之间最多有$\dfrac{\varepsilon N^2}{2}$个正关系边. 

设$x$为集合$X$中的节点数, $y$为集合$Y$中的节点数. 如果$x\ge (1-\delta)N> \dfrac{1}{2}N$. 此时$X$中的负关系边占比至多为
$$
\mathrm{prop}(\mathrm{neg}) \le \dfrac{\varepsilon N^2 / 2}{x(x-1)/2} <\delta 
$$
符合情形1的情况. 同理,  如果$y\ge (1-\delta)N> \dfrac{1}{2}N$, 也符合情形1的情况.

当$X$和$Y$都含有少于$(1-\delta) N$个节点时. 对于$X$和$Y$之间的边, 正关系边的占比至多为
$$
\mathrm{prop}(\mathrm{pos}) = \dfrac{\varepsilon N^2 / 2}{x y} <\dfrac{\varepsilon N^2 / 2}{\delta(1-\delta)N^2} < \delta
$$
对$X$和$Y$内部的边, 负关系边的占比至多为
$$
\mathrm{prop}(\mathrm{neg}) = \dfrac{\varepsilon N^2 / 2}{x(x-1)/2} < \dfrac{\varepsilon N^2 / 2}{\delta^2N^2/2} = \delta
$$
这就证明了其符合情形2的情况. 
#####
___

## 2. 网络中的议价与权力
### 2.1. 网络中的位置权力
1. **依赖性(dependence)**: 某些节点社会关系的价值完全来源于另一个节点的存在. 例如下图中的节点$A$和$C$完全依赖于$B$而存在, 但对于$B$来说, 它有多种选择
2. **排他性(exclusion)**: 某个节点可以单方面任意选择一个节点，但被选择的节点没有其他选择的权力. 例如下图中的节点$B$对$A$和$C$有排他性的权力, 但$B$对$D$不具有排他性的权力. 
3. **饱和性(satiation)**: 对于一个足够有权力的节点而言, 建立新的关系的边际收益递减
4. **介数(betweenness)**: 一个具有高介数的节点应该出现在许多其他节点对的路径上, 一般而言介数是中心性测度的反映. 例如下图中的节点$B$具有高介数. 但是介数高的点在某些情况下未必拥有很大的权力。

![1cd5851e450a43280906274ab434387](./Lecture%201.%20%E5%85%B3%E7%B3%BB%E7%9A%84%E5%B9%B3%E8%A1%A1%E5%92%8C%E8%AE%AE%E4%BB%B7.assets/1cd5851e450a43280906274ab434387.png)

### 2.2. 纳什议价解

当$A$和$B$就如何划分$\$1$进行谈判时, 若$A$有外部选项$x$, $B$有外部选项$y$, 且$x+y\le 1$. 则$A, B$两人等分$1-x-y$的剩余, 我们把这种情形下$A$和$B$获得的最终钱数称为纳什议价解. 

### 2.3. 稳定结果
给定一组匹配和节点价值, 不稳定性是指对于任意不在匹配中的边, 其两个端点$X$和$Y$的价值之和小于$1$. 一个网络交换的结果是稳定的, 当且仅当它不包含任何不稳定性. 

### 2.4. 平衡结果
给定一组匹配和节点价值, 网络中其余部分为每个节点提供了最好的外部选项. 一个交换结果称为平衡的条件是, 对于匹配中的每条边来说, 价值的划分体现了这两个节点的纳什议价解结果. 

![image-20230710135620824](./Lecture%201.%20%E5%85%B3%E7%B3%BB%E7%9A%84%E5%B9%B3%E8%A1%A1%E5%92%8C%E8%AE%AE%E4%BB%B7.assets/image-20230710135620824.png)

## 3. 匹配定理
### 3.1. 完美匹配
称一个匹配为一个完美匹配, 如果
1. 二部图的两边有数目相同的节点, 每个节点都有边连接到另一边的节点. 
2. 不会出现左边的两个节点同时连接到右边的同一个节点上. 

一个完美匹配就是二部图中的一组边, 图中的每一个节点恰好是一条边的端点. 

### 3.2. 限制组
取二部图右边的任意一组节点$S$, 将左边通过边与其相连的节点称为$S$的邻居, 用$N(S)$表示所有$S$的邻居的集合. 如果$|S|>|N(S)|$, 则称$S$是一个限制组.

### 3.3. 匹配定理
如果一个两边节点个数相等的二部图无法形成完美匹配, 那么它一定含有一个受限组. 
___
##### Proof
1. 在二部图中, 对于一个匹配, 如果存在一条其两个端点都是非匹配节点的交替通路(匹配和不匹配交替). 则可以利用这个交替通路放大匹配. 基于这一点, 我们称带有非匹配端点的交替通路为增强通路(augmenting path). 
2. 对二部图使用交替宽度优先搜索(alternating BFS). 交替BFS的工作方式如下, 从右边的任意一个非匹配的节点开始, 然后, 进行宽度优先搜索(对于偶数层, 只搜索非匹配边, 对于奇数层, 只搜索匹配边), 如果这种宽度优先搜索过程中一旦产生了一个层次, 其中包含了一个来自图左边的非匹配节点, 我们就发现了一条增强通路. 
3. 如果在搜索结束时, 没有发现任何一个增强通路. 这意味着在奇数层中没有找到任何一个非匹配节点, 因此在每一个奇数层, 节点都通过它们的匹配边连接到下一层的不同节点. 这样, 算上第一层中的节点$W$, 偶数层的节点比奇数层的节点恰好多$1$. 不难验证, 所有偶数层的节点恰好形成了一个限制组.
![image-20230709144645146](./Lecture%201.%20%E5%85%B3%E7%B3%BB%E7%9A%84%E5%B9%B3%E8%A1%A1%E5%92%8C%E8%AE%AE%E4%BB%B7.assets/image-20230709144645146.png)

因此对于任何指明了一个匹配的二部图, 设$W$是右边的任何未匹配节点, 如果不存在一个从$W$开始的增强通路, 则存在一个包含了$W$的限制组. 这就证明了匹配定理. 
#####

___

## 4. 最优分配
### 4.1. 最优分配
最优分配指的是在一组个体对一组对象进行估值的场合中, 使得社会总估值最高的分配方式.

完美匹配是最优分配在所有个体对所有对象估值全为1时的一个特例. 

### 4.2. 市场清仓价格
如果卖家把价格设定合适, 那么在人们追逐自我利益(自我利益$=$估值$-$价格)的过程中, 所有买家都不会阻碍别的买家而分别购买到不同的商品. 我们把这组价格称为市场清仓价格.

给定买家的估值和卖家的价格, 我们可以构造如下图所示的偏好卖家图. 


![image-20230709145658812](./Lecture%201.%20%E5%85%B3%E7%B3%BB%E7%9A%84%E5%B9%B3%E8%A1%A1%E5%92%8C%E8%AE%AE%E4%BB%B7.assets/image-20230709145658812.png)


### 4.3. 市场清仓定理
对于任何一组市场清仓价格, 偏好卖家图中的完美匹配使得估值总和在所有的买家和卖家的配对中达到最高. 
___
##### Proof
偏好卖家图的任意一组完美匹配$M$可以最大化每个买家的回报, 因此也就最大化了所有买家的回报.  而买家的估值总和是买家的回报总和加上价格总和. 因此, 任何一组完美匹配都可以最大化估值总和.
#####
___

### 4.4. 市场清仓价格的构造(整数价格)
1. 初始化: 所有卖家都把价格设置为$0$, 买家通过选择他们的偏好卖家做出反应. 如果偏好卖家图中含有完美匹配, 则得到了一个市场清仓价格.
2. 迭代: 如果偏好卖家图的完美匹配不存在, 则存在一个受限组$S$和他们的邻居$N(S)$. $N(S)$中的每个卖家同时把出价提高一个单位. 与此同时, 统一约减卖家价格, 使得最低价格为$0$, 用新的价格构建偏好卖家图. 

经过有限步的迭代, 一定可以得到一组市场清仓价格. 
___
##### Proof
对于任何当前价格集合, 定义一个买家的势能(potential of a buyer)是他当前可能获得的最大回报. 定义一个卖家的是能(potential of a seller)为他当前给出的价格. 定义拍卖的势能为所有参与者的势能之和, 包括买家和卖家. 

开始, 所有卖家的势能都为$0$, 每个买家的势能等于其最大估值. 于是, 开始时拍卖的势能就是某个整数$P_0\ge 0$. 在之后的每一轮中, 只能始终大于等于$0$. 对于$N(S)$中的每个卖家, 他们的势能增加了$1$, 但$S$中的每个买家他们的势能减少了$1$, 由于$|S|>|N(S)|$, 因此拍卖的势能总和下降的比上升的多. 因此, 拍卖的势能在每一轮中都会减少. 由于拍卖的势能是一个非负整数, 因此经过有限步迭代, 一定可以得到一组市场清仓价格. 
#####
___